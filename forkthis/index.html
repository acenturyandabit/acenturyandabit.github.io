<head>
    <!-- database -->
    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <script src="https://www.gstatic.com/firebasejs/6.6.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/6.6.0/firebase-firestore.js"></script>

    <!-- TODO: Add SDKs for Firebase products that you want to use
     https://firebase.google.com/docs/web/setup#config-web-app -->
</head>

<body>

    <script>
        // Your web app's Firebase configuration
        var firebaseConfig = {
            apiKey: "AIzaSyA-sH4oDS4FNyaKX48PSpb1kboGxZsw9BQ",
            authDomain: "backbits-567dd.firebaseapp.com",
            databaseURL: "https://backbits-567dd.firebaseio.com",
            projectId: "backbits-567dd",
            storageBucket: "backbits-567dd.appspot.com",
            messagingSenderId: "894862693076",
            appId: "1:894862693076:web:30065e02b66cb1f3e0a141"
        };
        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        var db = firebase.firestore();

        var node = {
            id: "asdfasdfs",
            data: "stuff",
            parent: "werwer"
        }
        var nodes = { node };

        function findFirstChild(id){
            for (let i in nodes){
                if (nodes[i].parent==id){
                    return i;
                }
            }
            return undefined;
        }
        function render(node, single = false) { // same as display function for now
            if (!node)return;
            //check if its parent exists
            if (!single) {
                if (!document.querySelector(`div#${node.id}`)) {
                    // if not, then render the parent quickly
                    render(nodes[node.parent], true);
                }
            }
            //do i already exist? If not, then create me
            if (!document.querySelector(`div#${node.frame}`)) {
                //does my frame exist? if not, then create my frame.
                if (!document.querySelector(`div#${node.frame}`)) {
                    let d = document.createElement(div);
                    d.id = node.frame;
                    d.innerHTML = `
                    <div>&lt;</div>
                    <div class="frames">
                    <div> + </div>
                    </div>
                    <div>&gt;</div>
                    `;
                    document.appendChild(d);
                }
                let frm = document.querySelector(`div#${node.frame} div.frames`);
                let d = document.createElement(div);
                d.id = node.id;
                frm.appendChild(d);
            }
            //hide other alternatives in frame
            let others = document.querySelector(`div#${node.frame} div.frames`).children;
            for (let i = 0; i < others.length; i++) {
                others.style.display = "none";
            }
            //make me visible
            document.querySelector(`div#${node.frame}`).style.display = "block";
            document.querySelector(`div#${node.frame}`).scrollIntoViewIfNeeded();
            //render a frame for a child of my choice
            render(nodes[findFirstChild(node.id)]);
        }
    </script>
</body>